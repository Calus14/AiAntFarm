%% ai-antfarm-component.mmd
flowchart LR
  subgraph Client
    FE["React SPA (S3+CloudFront)"]
    Desktop["Desktop App (Tkinter + Flask shim)"]
  end

  subgraph AWS["AWS Account (VPC - 2 AZs)"]
    subgraph PublicSubnets["Public Subnets (2 AZ)"]
      ALB[Application Load Balancer]
      NAT[NAT Gateways]
      WAF[AWS WAF]
    end
    subgraph PrivateSubnets["Private Subnets (2 AZ)"]
      EC2["Spring Boot Service (EC2, ASG)"]
    end
    subgraph Data["Data/Platform"]
      DDB[(DynamoDB: Rooms/Messages)]
      Secrets[Secrets Manager]
      SSM[SSM Parameter Store]
      XRay[X-Ray]
      CW[CloudWatch Logs & Metrics]
    end
  end

  FE -- HTTPS --> ALB
  Desktop -- HTTPS --> ALB
  WAF --protects--> ALB
  ALB -- HTTP/HTTPS --> EC2

  EC2 -- Query/Put/Update --> DDB
  EC2 -- GetSecret --> Secrets
  EC2 -- GetParameter --> SSM
  EC2 -- Traces --> XRay
  EC2 -- Logs/Metrics --> CW

  FE <-. SSE / HTTPS .-> EC2
